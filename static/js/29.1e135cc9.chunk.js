"use strict";(self.webpackChunkimonitor=self.webpackChunkimonitor||[]).push([[29],{11029:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var s=n(74165),r=n(15861),a=n(29439),c=n(72791),i=n(43621),o=n(73728),d=n(72426),l=n.n(d),u=n(80184);var m=function(e){var t=e.announceinfo,n=e.setGetId,d=e.setGetTitle,m=e.setGetMessage,x=e.setGetDate,f=e.setGetFiles,h=e.setGetFileName,v=(e.RunStudentSubmission,e.setGetFileSubmit),p=e.setGetPostedBy,j=e.setCounter,w=e.setGetReadsBy,b=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var n,r,a,c,o,d,l,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=!1,e.next=4,i.Z.storage.from("AnnouncementAttachmentFiles").list(t.announcementTitle);case 4:if(a=e.sent,c=a.data,o=a.error)console.error("Error fetching file list:",o);else{for(d=0;d<c.length;d++)r=c[d].name,h(r),n=!0;n?(l=i.Z.storage.from("AnnouncementAttachmentFiles").getPublicUrl("".concat(t.announcementTitle,"/").concat(r),{download:!0}),u=l.data,f(u)):f(null)}e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.error("No File"),e.abrupt("return");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),N=(0,c.useState)(0),g=(0,a.Z)(N,2),S=g[0],Z=g[1],y=(0,c.useState)(0),k=(0,a.Z)(y,2),E=k[0],A=k[1],D=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var n,r,a,c,o,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.storage.from("StudentAnnouncementSubmit").list(t.announcementTitle+"/");case 2:return n=e.sent,r=n.data,n.error,a=Array.from(new Set(r.map((function(e){return e.name.split("/")[0]})))),v(a),c=r.map((function(e){return e.name.split("/")[0]})).filter((function(e,t,n){return n.indexOf(e)===t})),Z(c.length),e.next=12,i.Z.from("StudentInformation").select("*",{count:"exact"});case 12:o=e.sent,d=o.count,A(d),j("".concat(S," / ").concat(E));case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){D()}),[S,E]);var G,T=l()(new Date(t.announcementEndDate)).format("Y/M/D"),F=(l()(new Date(t.announcementStartDate)).format("Y/M/D"),l()(new Date).format("Y/M/D"));return(0,u.jsx)("div",{className:"hover:cursor-pointer p-2 rounded-md",children:(0,u.jsxs)("div",{onClick:function(){return n(t.id),m(t.announcementMessage),d(t.announcementTitle),x(t.announcementStartDate),p(t.PostedBy),w(t.readsBy),b(),void D()},className:"z-0 bg-gray-100 p-3 text-start rounded-md hover:bg-gray-400 hover:cursor-pointer hover:translate-x-3  w-[230px]  h-[100px] text-[15px] overflow-hidden duration-500 hover:shadow-lg hover:shadow-black",children:[(0,u.jsxs)("label",{className:"truncate flex items-center",children:[l()(T).isBefore(F)&&(0,u.jsx)("em",{children:(0,u.jsx)(o.TqP,{className:"text-[20px]"})}),(G=t.announcementTitle,G.split(".")[1])]}),(0,u.jsxs)("div",{className:"grid text-[12px] font-thin",children:[(0,u.jsxs)("label",{children:["START: ",t.announcementStartDate]}),(0,u.jsxs)("label",{children:["END: ",t.announcementEndDate]})]}),(0,u.jsxs)("div",{className:"flex text-[12px] font-thin",children:["Student Submissions:",(0,u.jsx)("div",{className:"text-blue-600 ml-2",children:0===E?"-/-":"".concat(S,"/").concat(E)})]})]})})};var x=function(e){var t=e.date,n=l()(t).format("LLL");return(0,u.jsx)("div",{className:"ml-1",children:n})},f=n(67945),h=n.n(f);n(24655);var v=function(e){var t=e.studname,n=e.announcementTitle,o=(0,c.useState)([]),d=(0,a.Z)(o,2),l=d[0],m=d[1],f=(0,c.useState)([]),v=(0,a.Z)(f,2),p=(v[0],v[1],(0,c.useState)(!1)),j=(0,a.Z)(p,2),w=j[0],b=j[1];(0,c.useEffect)((function(){h().init({duration:500})}),[]);var N=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var r,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.storage.from("StudentAnnouncementSubmit").list(n+"/"+t+"/");case 2:r=e.sent,a=r.data,r.error,m(a);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=(0,c.useRef)(null),S=function(e){g.current&&!g.current.contains(e.target)&&b(!1)};return(0,c.useEffect)((function(){return document.addEventListener("mousedown",S),function(){document.removeEventListener("mousedown",S)}}),[]),(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)("div",{ref:g,onClick:function(){return b(!w),void N()},className:"bg-slate-200  hover:translate-x-2 hover:shadow-md hover:shadow-black duration-500 cursor-pointer  p-2 mt-2 rounded-md",children:[(0,u.jsxs)("p",{className:"font-semibold",children:[" ",t]}),w&&(0,u.jsx)("div",{children:(0,u.jsxs)("div",{className:"font-semibold text-[14px] h-[100px] overflow-y-auto",children:["File Submitted:",l.sort((function(e,t){return e.created_at<t.created_at?1:-1})).map((function(e,s){return(0,u.jsxs)("div",{className:"".concat(0===s?" text-[14px] shadow-[0_0px_20px_-15px_rgba(0,0,0,2)] p-3":"text-[10px] bg-slate-300 p-2"," rounded-md mt-2"),children:[(0,u.jsxs)("div",{className:"flex",children:["Submitted: ",(0,u.jsx)(x,{date:e.created_at})]}),"Donwload File:",(0,u.jsx)("a",{onClick:function(){return window.open("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/StudentAnnouncementSubmit/".concat(n,"/").concat(t,"/").concat(e.name))},className:"hover:underline text-blue-700 w-fit ml-1",children:e.name})]},e.name)}))]})})]})})},p=n(16856);var j=function(e){var t=e.getreadsBy,n=e.seen,o=(0,c.useState)(),d=(0,a.Z)(o,2),l=d[0],m=d[1];function x(){return x=(0,r.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.from("StudentInformation").select();case 2:t=e.sent,n=t.data,m(n);case 5:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}(0,c.useEffect)((function(){!function(){x.apply(this,arguments)}()}),[t]);var f=function(e){var t=[];if(l)for(var n=0;n<l.length;n++)l[n].studemail===e&&(t=l[n]);return(0,u.jsx)("div",{children:t&&(0,u.jsx)(u.Fragment,{children:"".concat(t.studname?t.studname:e)})})};return n?(0,u.jsxs)("div",{className:"p-1",children:["Seen By:",(0,u.jsx)("div",{className:"",children:t.map((function(e,t){return(0,u.jsx)("div",{className:"p-1 cursor-default",children:f(e)},t)}))})]}):null};n(20216);var w=function(){var e=(0,c.useState)([]),t=(0,a.Z)(e,2),n=(t[0],t[1],(0,c.useState)([])),o=(0,a.Z)(n,2),d=o[0],l=o[1],x=(0,c.useState)(""),f=(0,a.Z)(x,2),w=f[0],b=f[1],N=(0,c.useState)(""),g=(0,a.Z)(N,2),S=g[0],Z=g[1],y=(0,c.useState)(""),k=(0,a.Z)(y,2),E=k[0],A=k[1],D=(0,c.useState)(""),G=(0,a.Z)(D,2),T=G[0],F=G[1],C=(0,c.useState)(""),L=(0,a.Z)(C,2),B=L[0],_=L[1],M=(0,c.useState)(""),W=(0,a.Z)(M,2),P=(W[0],W[1],(0,c.useState)([])),R=(0,a.Z)(P,2),z=R[0],I=R[1],O=(0,c.useState)(),U=(0,a.Z)(O,2),Y=U[0],q=U[1],H=(0,c.useState)(),J=(0,a.Z)(H,2),K=J[0],Q=J[1],V=(0,c.useState)([]),X=(0,a.Z)(V,2),$=X[0],ee=X[1],te=(0,c.useState)(),ne=(0,a.Z)(te,2),se=ne[0],re=ne[1],ae=(0,c.useState)(!1),ce=(0,a.Z)(ae,2),ie=ce[0],oe=ce[1],de=(0,c.useState)(!1),le=(0,a.Z)(de,2),ue=le[0],me=le[1];(0,c.useEffect)((function(){h().init({duration:1e3})}),[]),(0,c.useEffect)((function(){xe(),me(!0);i.Z.channel("custom-all-channel").on("postgres_changes",{event:"*",schema:"public",table:"AnnouncementTable"},(function(){xe()})).subscribe()}),[]);var xe=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.from("AnnouncementTable").select();case 2:t=e.sent,n=t.data,r=t.error,n&&l(n),r&&console.log(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=(0,c.useState)(window.innerWidth<=768),he=(0,a.Z)(fe,2),ve=(he[0],he[1]),pe=(0,c.useState)(window.innerWidth>=768),je=(0,a.Z)(pe,2),we=(je[0],je[1]);(0,c.useEffect)((function(){var e=function(){ve(window.innerWidth<=768),we(window.innerWidth>=768),window.innerWidth<=768&&me(!1),window.innerWidth>=768&&me(!0)};e(),window.addEventListener("resize",e)}),[]);var be=(0,c.useRef)(null),Ne=function(e){be.current&&!be.current.contains(e.target)&&oe(!1)},ge=(0,c.useRef)(null),Se=function(e){window.innerWidth<=768&&ge.current&&!ge.current.contains(e.target)&&me(!1)};(0,c.useEffect)((function(){return document.addEventListener("mousedown",Se),document.addEventListener("mousedown",Ne),function(){document.removeEventListener("mousedown",Se),document.removeEventListener("mousedown",Ne)}}),[]);var Ze,ye=(0,c.useState)(""),ke=(0,a.Z)(ye,2),Ee=ke[0],Ae=ke[1];return(0,u.jsxs)("div",{className:"flex gap-1 md:pl-5 pl-1 bg-black bg-opacity-20  h-screen md:pt-0 pt-10",children:[(0,u.jsxs)("div",{ref:ge,onClick:function(){window.innerWidth<=768&&me(!ue)},className:"".concat(ue?" bg-[#c8d7e5] md:h-[85%] h-[75%] items-center rounded-l-md mt-5   ":"w-[50px] bg-[#c8d7e5] md:h-[85%] h-[75%] rounded-l-md mt-5 md:ml-0 ml-2"," shadow-black shadow-md"),children:[(0,u.jsx)("div",{onClick:function(){return me(!ue)},className:"".concat(ue?" text-[25px] justify-center flex group":"flex pl-[20px] z-10 text-[19px] text-blue-500","   font-bold pt-3 pb-3 rounded-tl-md duration-100"),children:ue?(0,u.jsx)("div",{className:" pr-2 pl-2 ",children:"Announcement"}):(0,u.jsxs)("div",{className:"  text-center font-mono -ml-1 mt-10",children:[(0,u.jsx)("div",{children:"A"}),(0,u.jsx)("div",{children:"N"}),(0,u.jsx)("div",{children:"N"}),(0,u.jsx)("div",{children:"O"}),(0,u.jsx)("div",{children:"U"}),(0,u.jsx)("div",{children:"N"}),(0,u.jsx)("div",{children:"C"}),(0,u.jsx)("div",{children:"E"}),(0,u.jsx)("div",{children:"M"}),(0,u.jsx)("div",{children:"E"}),(0,u.jsx)("div",{children:"N"}),(0,u.jsx)("div",{children:"T"})]})}),(0,u.jsx)("div",{className:"h-screen",children:0!==d.length?(0,u.jsxs)("div",{className:"".concat(ue?"":"hidden","  duration-500  overflow-y-auto overflow-x-hidden md:h-[70%] h-[55%] w-auto p-2"),children:[(0,u.jsx)("div",{className:"mt-1 flex justify-center",children:(0,u.jsx)("input",{type:"search",placeholder:"Search",className:"pl-2 rounded-md  w-[245px] outline-none focus:shadow-sm   focus:shadow-black ",value:Ee,onChange:function(e){return Ae(e.target.value)}})}),d.sort((function(e,t){return e.announcementEndDate<t.announcementEndDate?1:-1})).filter((function(e){try{var t=e.announcementTitle.split(".")[1].toLowerCase();if(""===Ee)return e;if(t.includes(Ee.toLowerCase()))return e}catch(n){}})).map((function(e){return(0,u.jsx)(m,{announceinfo:e,setGetId:b,setGetTitle:Z,setGetMessage:A,setGetDate:F,setGetPostedBy:_,setGetFiles:I,setGetFileName:q,setGetFileSubmit:ee,setCounter:Q,setGetReadsBy:re},e.id)}))]}):(0,u.jsx)("div",{className:"".concat(!ue&&"hidden"," text-center mt-[70%] font-semibold md:text-[25px] text-[15px]"),children:"No Announcement"})})]}),(0,u.jsxs)("div",{className:"flex flex-col w-[100%] duration-500",children:[(0,u.jsxs)("div",{className:"flex-col mt-5   bg-[#c8d7e5] md:h-[38%] h-[28%] p-3 rounded-tr-md overflow-y-auto w-[98%] shadow-black shadow-md",children:[(0,u.jsx)("div",{className:"",children:w?(0,u.jsxs)("div",{className:" overflow-y-auto  p-5",children:[(0,u.jsxs)("div",{className:"font-bold text-[25px] md:flex grid items-center",children:[(0,u.jsxs)("div",{className:" ",children:[(0,u.jsx)("div",{children:(0,u.jsx)(p.FpO,{onClick:function(){return oe(!0)},className:"hover:text-blue-500 text-[20px] cursor-pointer"})}),(0,u.jsx)("div",{ref:be,className:"bg-[#5885afe2] max-h-[100px] min-w-[200px] w-auto text-sm absolute text-slate-100 overflow-x-auto  rounded-md",children:(0,u.jsx)(j,{seen:ie,getreadsBy:se})})]}),"Announcement Title: ",(Ze=S,Ze.split(".")[1])]}),(0,u.jsxs)("div",{className:"font-semibold grid text-[12px] mb-10",children:[(0,u.jsxs)("label",{children:["Posted By: ",B]}),(0,u.jsxs)("label",{children:["Posted: ",T]})]}),(0,u.jsx)("div",{className:"mb-2 font-semibold",children:" Announcement Message:"}),(0,u.jsx)("div",{className:"text-justify",children:E}),z&&(0,u.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,u.jsx)("h3",{children:"Download Link:"}),(0,u.jsx)("a",{href:z.publicUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:Y})]})]}):(0,u.jsx)("div",{className:"text-center  font-bold text-[25px] mt-[10%]",children:"Announcement Information will display here"})}),w&&(0,u.jsx)("div",{className:"flex gap-1 items-center"})]}),(0,u.jsxs)("div",{className:"bg-[#c8d7e5] h-[46.5%]  overflow-y-auto w-[98%] mt-1 rounded-br-md shadow-black shadow-md",children:[(0,u.jsx)("div",{className:"bg-[#5885AF] text-center p-2 font-semibold text-[20px]",children:"Student Submissions"}),w?(0,u.jsxs)("div",{className:"p-2 h-[100%]",children:[(0,u.jsxs)("div",{className:"flex ",children:["Student Submitted: ",K," "]}),$&&$.length>0?(0,u.jsx)(u.Fragment,{children:$.map((function(e,t){return(0,u.jsx)(v,{studname:e,announcementTitle:S},t)}))}):(0,u.jsx)("div",{className:" flex items-center justify-center place-content-center text-[20px] mt-[10%] font-semibold",children:"No Submissions"})]}):(0,u.jsx)("div",{className:"text-center  font-semibold text-[20px] mt-[10%]",children:"Student submission will display here"})]})]})]})}}}]);
//# sourceMappingURL=29.1e135cc9.chunk.js.map