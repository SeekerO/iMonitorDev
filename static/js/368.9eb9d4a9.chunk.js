"use strict";(self.webpackChunkimonitor=self.webpackChunkimonitor||[]).push([[368],{48368:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var a=n(74165),r=n(15861),s=n(29439),c=n(72791),i=n(43621),o=n(72426),l=n.n(o),u=n(40071),d=n(56355),m=n(80184),p=function(e){var t=e.announcementinfo,n=e.setGetId,o=e.setGetMessage,p=e.setGetTitle,f=e.setGetDate,x=e.setGetEndDate,h=e.setGetAllow,v=e.setGetFiles,b=e.setGetFileName,w=e.setGetPostedBy,g=e.studemail,j=e.ReactTooltip,y=(0,c.useState)([]),Z=(0,s.Z)(y,2),N=(Z[0],Z[1],(0,c.useState)(!1)),k=(0,s.Z)(N,2),S=k[0],E=(k[1],(0,c.useState)()),A=(0,s.Z)(E,2),G=(A[0],A[1],(0,c.useState)(!1)),L=(0,s.Z)(G,2),O=L[0],C=L[1],D=new Date,T=new Date(t.announcementEndDate);var B=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var n,r,s,c,o,l,u,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=!1,e.next=4,i.Z.storage.from("AnnouncementAttachmentFiles").list(t.announcementTitle);case 4:if(s=e.sent,c=s.data,o=s.error)console.error("Error fetching file list:",o);else{for(l=0;l<c.length;l++)r=c[l].name,b(r),n=!0;n?(u=i.Z.storage.from("AnnouncementAttachmentFiles").getPublicUrl("".concat(t.announcementTitle,"/").concat(r),{download:!0}),d=u.data,v(d)):v(null)}e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.error("No File"),e.abrupt("return");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var n,r,s,c,o,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=l()().format("LLL"),e.next=4,i.Z.from("StudentInformation").select().eq("studemail",g).single();case 4:return r=e.sent,s=r.data,c=s.studname,o=t.announcementTitle,e.next=10,i.Z.from("ActivityLog").insert([{name:c,button:o,time:n}]);case 10:u=e.sent,u.data,e.next=16;break;case 14:e.prev=14,e.t0=e.catch(0);case 16:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var n,r,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.readsBy,r=!1,s=0;s<n.length;s++)n[s]===g&&(r=!0);if(r){e.next=9;break}return n.push(g),e.next=7,i.Z.from("AnnouncementTable").update({readsBy:n}).eq("id",t.id);case 7:c=e.sent,c.data;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){!function(){for(var e=!0,n=t.readsBy,a=0;a<n.length;a++)n[a]===g&&(e=!1);e&&C(!0)}()}),[t]);var M;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{children:(0,m.jsxs)("div",{onClick:function(){return function(){try{P(),n(t.id),o(t.announcementMessage),p(t.announcementTitle),f(t.announcementStartDate),x(t.announcementEndDate),h(t.announcementAllow),w(t.PostedBy),B(),F(),C(!1)}catch(e){}}()},className:" ".concat(l()(T).isBefore(D)?"bg-gray-400 text-black h-20 p-1 rounded-md ":"".concat(S?"bg-black":" text-black h-24 p-1 rounded-md  hover:shadow-md hover:shadow-black hover:translate-x-1 duration-300")," \n   "),children:[(0,m.jsxs)("div",{className:"flex items-center gap-0.5",children:[O?(0,m.jsx)(u.NZ2,{className:"text-red-600 text-[20px]"}):null,(0,m.jsxs)("p",{className:"font-bold md:text-[20px] text-[10px] line-clamp-1 flex items-center",children:[l()(T).isBefore(D)&&(0,m.jsx)(d.ceS,{className:" bg-[#274472 rounded-full p-1 text-[25px] text-black","data-tooltip-id":"History"})," ",(M=t.announcementTitle,M.split(".")[1])]})]}),(0,m.jsx)("p",{className:"md:text-[15px] text-[10px]",children:t.announcementStartDate})]})}),(0,m.jsx)(j,{id:"History",place:"right",variant:"info",content:"History"})]})},f=(n(14070),n(75985)),x=n(51921),h=n(20216),v=n(30203);var b=function(e){var t=e.studemail,n=(0,c.useState)([]),o=(0,s.Z)(n,2),u=o[0],d=o[1],b=(0,c.useState)(!1),w=(0,s.Z)(b,2),g=w[0],j=w[1],y=(0,c.useState)(""),Z=(0,s.Z)(y,2),N=(Z[0],Z[1]),k=(0,c.useState)(),S=(0,s.Z)(k,2),E=S[0],A=S[1],G=(0,c.useState)(""),L=(0,s.Z)(G,2),O=L[0],C=L[1],D=(0,c.useState)(""),T=(0,s.Z)(D,2),B=T[0],F=T[1],P=(0,c.useState)(""),M=(0,s.Z)(P,2),I=M[0],z=M[1],U=(0,c.useState)(""),H=(0,s.Z)(U,2),R=H[0],_=H[1],q=(0,c.useState)(""),W=(0,s.Z)(q,2),V=W[0],$=W[1],J=(0,c.useState)(""),K=(0,s.Z)(J,2),Q=K[0],X=K[1],Y=(0,c.useState)(""),ee=(0,s.Z)(Y,2),te=ee[0],ne=ee[1],ae=(0,c.useState)([]),re=(0,s.Z)(ae,2),se=re[0],ce=re[1],ie=(0,c.useState)(),oe=(0,s.Z)(ie,2),le=oe[0],ue=oe[1],de=(0,c.useState)(),me=(0,s.Z)(de,2),pe=me[0],fe=me[1],xe=(0,c.useState)(!1),he=(0,s.Z)(xe,2),ve=he[0],be=he[1],we=(0,c.useState)(!1),ge=(0,s.Z)(we,2),je=ge[0],ye=ge[1];(0,c.useEffect)((function(){Me(),Be();i.Z.channel("custom-all-channel").on("postgres_changes",{event:"*",schema:"public",table:"AnnouncementTable"},(function(e){Me(),Be()})).subscribe()}),[]);var Ze=(0,c.useState)(!1),Ne=(0,s.Z)(Ze,2),ke=Ne[0],Se=Ne[1],Ee=(0,c.useState)([]),Ae=(0,s.Z)(Ee,2),Ge=Ae[0],Le=Ae[1],Oe=(0,c.useState)(),Ce=(0,s.Z)(Oe,2),De=Ce[0],Te=Ce[1],Be=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.Z.from("StudentInformation").select().eq("studemail",t).single();case 3:n=e.sent,r=n.data,n.error,r&&A(r.studname),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),Fe=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0!==Ge.length){e.next=4;break}return f.Am.warn("No File Detected!",{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"}),e.abrupt("return");case 4:return be(!0),t=Math.floor(100*Math.random())+1,Se(!0),e.next=9,i.Z.storage.from("StudentAnnouncementSubmit").upload(B+"/"+E+"/"+t+De,Ge);case 9:n=e.sent,n.data1,Pe(),Le([]),be(!1),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(0);case 18:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();function Pe(){f.Am.info("File has been submitted!",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"}),setTimeout((function(){Se(!1)}),1e3)}function Me(){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,r.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.Z.from("AnnouncementTable").select();case 3:if(t=e.sent,n=t.data,t.error,!n){e.next=13;break}if(d(n),N(n.announcementTitle),!(n<1)){e.next=12;break}return j(!1),e.abrupt("return");case 12:j(!0);case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(0);case 17:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}function ze(){return(ze=(0,r.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.storage.from("StudentAnnouncementSubmit").list(B+"/"+E);case 2:t=e.sent,n=t.data,fe(n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,c.useEffect)((function(){!function(){ze.apply(this,arguments)}()}),[O,ve]);var Ue=l()(new Date).format("LLL"),He=l()(new Date(V)).format("LLL"),Re=(0,c.useState)(""),_e=(0,s.Z)(Re,2),qe=_e[0],We=_e[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(f.Ix,{limit:1}),(0,m.jsx)("div",{className:" flex justify-center h-screen ",children:(0,m.jsxs)("div",{className:"mt-[5%] h-[70%] flex gap-2 md:p-1 p-10",children:[(0,m.jsxs)("div",{className:"md:w-[240px] w-[140px] h-[100%] bg-slate-200 rounded-l-md shadow-md shadow-black",children:[(0,m.jsxs)("div",{className:"flex items-center justify-center gap-1 md:text-[24px] text-[12px] bg-[#274472] text-white p-2 font-semibold",children:[(0,m.jsx)("span",{children:(0,m.jsx)(v.GUV,{className:"md:text-[30px] text-[12px] h-fit "})}),"Announcement"]}),(0,m.jsx)("div",{className:"grid justify-center mt-2 w-[100%]",children:(0,m.jsx)("input",{type:"search",placeholder:"Search",className:"pl-2  text-center rounded-md p-1 w-full focus:shadow-black shadow-sm outline-none",value:qe,onChange:function(e){return We(e.target.value)}})}),(0,m.jsx)("div",{className:"overflow-y-auto overflow-x-hidden  w-full md:h-[80%] h-[60%] ",children:g?(0,m.jsx)("div",{className:"w-full",children:u.sort((function(e,t){return e.announcementEndDate<t.announcementEndDate?1:-1})).filter((function(e){try{var t=e.announcementTitle.split(".")[1].toLowerCase();if(""===qe)return e;if(t.includes(qe.toLowerCase()))return e}catch(n){}})).map((function(e){return(0,m.jsx)("div",{className:"hover:cursor-pointer p-1 rounded-md ",children:(0,m.jsx)(p,{announcementinfo:e,setGetId:C,setGetTitle:F,setGetDate:_,setGetEndDate:$,setGetMessage:z,setGetAllow:X,setGetFiles:ce,setGetFileName:ue,setGetPostedBy:ne,studemail:t,ReactTooltip:h.u})},e.id)}))}):(0,m.jsx)("div",{className:"flex items-center justify-center place-content-center h-[100%] w-[100%] text-center font-semibold md:text-[25px] text-[15px]",children:"No Announcement"})})]}),(0,m.jsx)("div",{className:"".concat(window.innerWidth<=768?"".concat(je?"hidden":"bg-slate-200  w-[100%] min-h-[100%] max-h-auto "):"w-[700px] h-[100%] bg-slate-200 rounded-r-md shadow-md shadow-black  "," "),children:O?(0,m.jsxs)("div",{id:"announcement",className:"pl-[2%] pt-3 pr-[2%] h-[90%]",children:[(0,m.jsxs)("div",{className:"flex justify-between items-start",children:[(0,m.jsx)("div",{className:"font-bold text-[20px]  overflow-x-auto md:min-h-10 md:max-h-20 h-[10%] ",children:function(e){return e.split(".")[1]}(B)}),(0,m.jsx)("a",{onClick:function(){return ye(!je)},className:"text-blue-600 underline cursor-pointer",children:"Submissions"})]}),(0,m.jsxs)("div",{className:"font-semibold text-[13px]",children:["Posted By: ",te]}),(0,m.jsxs)("div",{className:"font-medium text-[10px] mb-10",children:["Posted on ",R," | Until ",l()(V).format("LL")]}),(0,m.jsxs)("div",{className:"p-2 font-sans font-medium text-[15px] pl-2 h-[50%] mb-2 text-start overflow-y-auto ",children:[I,se&&(0,m.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,m.jsx)("h3",{children:"Download Link:"}),(0,m.jsx)("a",{href:se.publicUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:le})]})]}),ve?(0,m.jsxs)("div",{className:"flex flex-col text-blue-600 items-center",children:["Uploading please wait...",(0,m.jsx)(x.Z,{color:"#3e4de1",size:12})]}):(0,m.jsx)("div",{className:"",children:"true"===Q&&(0,m.jsx)("div",{className:"grid",children:(0,m.jsx)("div",{className:"",children:l()(Ue).isBefore(He)&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"font-semibold gap-4 flex ",children:["Upload file here"," "]}),(0,m.jsx)("input",{type:"file",onChange:function(e){var t=e.target.files,n=e.target.files[0];t.length>0&&(Le(n),Te(n.name))},className:" w-[200px] overflow-x-auto "}),(0,m.jsx)("button",{disabled:ke,onClick:Fe,className:"".concat(ke?"bg-gray-400 w-[100px] rounded-md p-1 text-black mt-2 ":" mt-2 w-[100px] rounded-md p-1 bg-blue-500 hover:bg-blue-700 text-white font-semibold"),children:"Submit"})]})})})})]}):(0,m.jsx)("div",{className:"justify-center text-center items-center flex h-[100%] w-[100%] font-semibold font-sans md:text-[30px] text-[20px]",children:"Announcement will display here"})}),je&&(0,m.jsxs)("div",{className:"bg-slate-200 md:w-[300px] w-[200px] rounded-md h-[100%] shadow-md shadow-black",children:[(0,m.jsxs)("div",{className:"flex items-center md:justify-center grid-cols-2 bg-[#274472]",children:[(0,m.jsx)("a",{onClick:function(){return ye(!je)},className:"".concat(window.innerWidth>=768?"hidden ":"mr-[10%] text-white underline cursor-pointer ml-2 text-[13px]"," duration-300 "),children:"Back"}),(0,m.jsx)("div",{className:"flex w-[100%] p-1 gap-1 items-center justify-center bg-[#274472] text-white rounded-tr-md",children:(0,m.jsx)("label",{className:"text-lg flex  font-semibold",children:"Submitted"})})]}),pe&&(0,m.jsx)("div",{className:" w-full",children:pe.sort((function(e,t){return e.created_at<t.created_at?1:-1})).map((function(e){return(0,m.jsxs)("div",{onClick:function(){return window.open("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/StudentAnnouncementSubmit/".concat(B,"/").concat(E,"/").concat(e.name))},className:"flex items-center w-[300px] h-[60px] bg-slate-400 gap-1 mb-0.5 hover:shadow-md hover:shadow-black duration-300 hover:translate-x-1 cursor-pointer default:cursor-pointer",children:[(0,m.jsx)("div",{className:"bg-slate-500 flex justify-center  h-[60px]  w-[50px] items-center text-white",children:(0,m.jsx)(v.cNx,{className:"text-[20px] cursor-pointer "})}),(0,m.jsxs)("div",{className:"w-full h-[50px]  flex flex-col font-thin",children:[(0,m.jsx)("label",{className:" w-[250px] overflow-hidden truncate ... cursor-pointer",children:e.name}),(0,m.jsx)("label",{className:"text-[12px] cursor-pointer",children:l()(e.created_at).format("LLL")})]})]},e.id)}))})]})]})})]})}},51921:function(e,t,n){var a=n(72791),r=n(75617),s=n(6707),c=function(){return c=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},c.apply(this,arguments)},i=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},o=(0,s.i)("BeatLoader","50% {transform: scale(0.75);opacity: 0.2} 100% {transform: scale(1);opacity: 1}","beat");t.Z=function(e){var t=e.loading,n=void 0===t||t,s=e.color,l=void 0===s?"#000000":s,u=e.speedMultiplier,d=void 0===u?1:u,m=e.cssOverride,p=void 0===m?{}:m,f=e.size,x=void 0===f?15:f,h=e.margin,v=void 0===h?2:h,b=i(e,["loading","color","speedMultiplier","cssOverride","size","margin"]),w=c({display:"inherit"},p),g=function(e){return{display:"inline-block",backgroundColor:l,width:(0,r.E)(x),height:(0,r.E)(x),margin:(0,r.E)(v),borderRadius:"100%",animation:"".concat(o," ").concat(.7/d,"s ").concat(e%2?"0s":"".concat(.35/d,"s")," infinite linear"),animationFillMode:"both"}};return n?a.createElement("span",c({style:w},b),a.createElement("span",{style:g(1)}),a.createElement("span",{style:g(2)}),a.createElement("span",{style:g(3)})):null}},6707:function(e,t,n){n.d(t,{i:function(){return a}});var a=function(e,t,n){var a="react-spinners-".concat(e,"-").concat(n);if("undefined"==typeof window||!window.document)return a;var r=document.createElement("style");document.head.appendChild(r);var s=r.sheet,c="\n    @keyframes ".concat(a," {\n      ").concat(t,"\n    }\n  ");return s&&s.insertRule(c,0),a}},75617:function(e,t,n){n.d(t,{E:function(){return s},h:function(){return r}});var a={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function r(e){if("number"===typeof e)return{value:e,unit:"px"};var t,n=(e.match(/^[0-9.]*/)||"").toString();t=n.includes(".")?parseFloat(n):parseInt(n,10);var r=(e.match(/[^0-9]*$/)||"").toString();return a[r]?{value:t,unit:r}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(t,"px.")),{value:t,unit:"px"})}function s(e){var t=r(e);return"".concat(t.value).concat(t.unit)}},14070:function(){}}]);
//# sourceMappingURL=368.9eb9d4a9.chunk.js.map