"use strict";(self.webpackChunkimonitor=self.webpackChunkimonitor||[]).push([[259],{75589:function(e,t,n){n.d(t,{Z:function(){return x}});var s=n(29439),a=n(72791),r=n(72426),c=n.n(r),o=n(80184);var i=function(e){var t=e.date,n=c()(t).startOf(t,"day").fromNow();return(0,o.jsxs)("div",{className:"ml-1",children:["Sent: ",n]})},l=n.p+"static/media/profile.7a6a6c54279a54d1977c.png",d=n(39126),u=n(53532),m=n(64802);var x=function(e){var t=e.message,n=e.beneName,r=e.getstudname,c=e.beneinfo,x=e.file,p=e.studID,f=e.avatarURL,h=(e.isRole,e.receivedmessages,e.allbeneinfo),g=(0,a.useState)(!1),v=(0,s.Z)(g,2),b=v[0],w=v[1],j=(0,a.useState)(),N=(0,s.Z)(j,2),y=N[0],Z=N[1],S=(0,a.useState)("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(p,"_").concat(c.id,"/").concat(c.id,"/").concat(t.message)),k=(0,s.Z)(S,2),z=k[0],C=k[1],M=(0,a.useState)("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(p,"_").concat(c.id,"/").concat(p,"/").concat(t.message)),_=(0,s.Z)(M,2),E=_[0],I=_[1],F=(0,a.useState)(!1),U=(0,s.Z)(F,2),L=U[0],A=U[1];function D(e){try{for(var n=0;n<x.length;n++)x[n].name===t.message&&("BENE"===c.ROLE?"Current"===e?q():B():"Current"===e?R():O())}catch(s){}}function q(){try{(0,m.saveAs)("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(p,"_").concat(c.id,"/").concat(c.id,"/").concat(t.message),t.message)}catch(e){}}function B(){try{(0,m.saveAs)("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(p,"_").concat(c.id,"/").concat(p,"/").concat(t.message),t.message)}catch(e){}}function R(){try{(0,m.saveAs)("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(c.id,"_").concat(p,"/").concat(c.id,"/").concat(t.message),t.message)}catch(e){}}function O(){try{(0,m.saveAs)("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(c.id,"_").concat(p,"/").concat(p,"/").concat(t.message),t.message)}catch(e){}}function P(){Z(t.message)}(0,a.useEffect)((function(){t.name===n&&t.contactwith===r&&!0===t.readmessage&&w(!0);for(var e=0;e<h.length;e++)r===h[e].beneName&&I("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(c.id,"_").concat(p,"/").concat(p,"/").concat(t.message))}),[t]),(0,a.useEffect)((function(){"BENE"!==c.ROLE&&(C("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(c.id,"_").concat(p,"/").concat(c.id,"/").concat(t.message)),I("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(c.id,"_").concat(p,"/").concat(p,"/").concat(t.message)))}),[c]);var W=function(){try{var e=t.message.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","bmp"].includes(e)?(0,o.jsx)("div",{className:"flex flex-col justify-center max-w-[300px] max-h-[300px] bg-white p-2 ml-2 rounded-md",children:(0,o.jsx)("div",{className:"text-right break-words ",children:(0,o.jsx)("div",{className:"text-right grid ",children:t.name===r&&t.contactwith===n?(0,o.jsx)("div",{className:"flex gap-2 items-center",children:y?(0,o.jsxs)("div",{className:"cursor-default",children:[" ",y]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("img",{onClick:function(){return A(!L)},className:"max-w-[240px] max-h-[250px] min-h-[150px] min-w-[180px]",onError:P,src:E}),(0,o.jsx)(u.Z,{name:t.message,imgsrc:E,visible:L,onClose:A})]})}):(0,o.jsx)("div",{className:"flex gap-2 items-center",children:y?(0,o.jsx)("div",{className:"cursor-default",children:y}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("img",{onClick:function(){return A(!L)},className:"max-w-[240px] max-h-[250px] min-h-[150px] min-w-[180px]",onError:P,src:z||E}),(0,o.jsx)(u.Z,{name:t.message,imgsrc:z,visible:L,onClose:A})]})})})})}):["docx","pdf","ods","pptx","xlsx"].includes(e)?(0,o.jsx)("div",{className:"flex flex-col justify-center max-w-[300px] h-auto bg-blue-900 text-white font-semibold  p-3 ml-2 rounded-md ",children:(0,o.jsxs)("div",{className:"text-right break-words  flex items-center gap-2 ",children:[(0,o.jsx)(d.VLk,{className:"text-[20px] "}),t.name===r&&t.contactwith===n?(0,o.jsx)("div",{onClick:function(){return D("User")},className:"text-left  w-[100%] hover:underline cursor-pointer",children:t.message}):(0,o.jsx)("div",{onClick:function(){return D("Current")},className:"text-right w-[100%] hover:underline cursor-pointer",children:t.message})]})}):(0,o.jsx)("div",{className:"flex flex-col justify-center max-w-[300px] h-auto bg-white p-2 ml-2 rounded-md cursor-default",children:(0,o.jsx)("div",{className:"text-right break-words cursor-default ",children:(0,o.jsx)("div",{onClick:function(){return D("Current")},className:"text-right cursor-default",children:t.message})})})}catch(s){}};return(0,o.jsx)(o.Fragment,{children:t&&(0,o.jsxs)("div",{children:[t.name===r&&t.contactwith===n&&(0,o.jsx)("div",{className:" mb-2 flex place-content-start ",children:(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsxs)("div",{className:" h-auto  flex",children:[f?(0,o.jsx)("img",{src:f,className:"  h-[40px] justify-center rounded-full"}):(0,o.jsx)("img",{src:l,className:"  h-[40px] justify-center rounded-full"}),W()]}),(0,o.jsxs)("div",{className:"text-right text-[9px] flex pt-1 ml-10 cursor-default",children:[(0,o.jsx)(i,{date:t.created_at}),b&&(0,o.jsx)(d.fC0,{className:"text-[15px] ml-1 text-green-600"})]})]})}),t&&(0,o.jsx)("div",{children:t.name===n&&t.contactwith===r&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:" mb-2 flex place-content-end",children:(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsx)("div",{className:" flex place-content-end",children:W()}),(0,o.jsxs)("div",{className:"place-content-end text-[9px] flex pt-1  cursor-default",children:[(0,o.jsx)(i,{date:t.created_at}),b&&(0,o.jsx)(d.fC0,{className:"text-[15px] ml-1 text-green-600"})]})]})})})}),!t&&"Something's wrong with the connection"]})})}},53532:function(e,t,n){var s=n(72791),a=n(58617),r=n(78820),c=n(64802),o=n(80184);t.Z=function(e){var t=e.imgsrc,n=e.visible,i=e.onClose,l=e.name,d=(0,s.useRef)(null),u=function(e){d.current&&!d.current.contains(e.target)&&i(!1)};return(0,s.useEffect)((function(){return document.addEventListener("mousedown",u),function(){document.removeEventListener("mousedown",u)}}),[]),n?(0,o.jsxs)("div",{className:"fixed inset-0  bg-black bg-opacity-30 backdrop-blur-lg flex-col justify-center  items-center z-50",children:[(0,o.jsx)("div",{className:"flex justify-end",children:(0,o.jsx)(r.oHP,{className:" mt-[10px] text-white text-[35px] font-semibold"})}),(0,o.jsxs)("div",{ref:d,className:"text-end m-20 place-content-center flex flex-col items-center",children:[(0,o.jsx)("img",{src:t,className:"max-h-[35%]  max-w-[35%] min-h-[100px]  min-w-[100px]"}),(0,o.jsxs)("a",{onClick:function(){return(0,c.saveAs)(t,l)},download:"computer",className:"text-white font-semibold flex items-center hover:text-blue-500 cursor-pointer",children:[(0,o.jsx)(a.H_7,{className:"text-[20px] "})," Download"]})," "]})]}):null}},97245:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var s=n(74165),a=n(15861),r=n(29439),c=n(72791),o=(n(58168),n(43621)),i=n(80184);var l=function(e){var t,n=e.beneinfo,l=e.setGetBeneName,d=e.message,u=e.setShowMessage,m=e.studName,x=(e.read,e.setGetID),p=(e.getFile,e.setAvatarColor),f=e.setAvatarURL,h=e.setOnlineStatus,g=(0,c.useState)([]),v=(0,r.Z)(g,2),b=(v[0],v[1]),w=(0,c.useState)(!1),j=(0,r.Z)(w,2),N=(j[0],j[1]),y=(0,c.useState)(),Z=(0,r.Z)(y,2),S=Z[0],k=Z[1],z=(0,c.useState)(!1),C=(0,r.Z)(z,2),M=C[0],_=C[1],E=(0,c.useState)(),I=(0,r.Z)(E,2),F=I[0],U=I[1],L=(0,c.useState)(0),A=(0,r.Z)(L,2),D=A[0],q=A[1];function B(e){var n,s=0;for(n=0;n<e.length;n+=1)s=e.charCodeAt(n)+((s<<5)-s);var a="#";for(n=0;n<3;n+=1){a+="00".concat((s>>8*n&255).toString(16)).slice(-2)}return t=a,a}function R(){return(R=(0,a.Z)((0,s.Z)().mark((function e(t){var n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.storage.from("ProfilePic").list(t+"/",{limit:1,offset:0});case 3:n=e.sent,(a=n.data)&&(_(!0),U("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/ProfilePic/".concat(t,"/").concat(a[0].name)),k("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/ProfilePic/".concat(t,"/").concat(a[0].name))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),_(!1);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function O(){return P.apply(this,arguments)}function P(){return(P=(0,a.Z)((0,s.Z)().mark((function e(){var t,a,r,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.from("Messaging").select("*",{count:"exact"}).match({name:n.beneName,contactwith:m,readmessage:"FALSE"});case 3:if(t=e.sent,a=t.data,r=t.count,!a){e.next=20;break}q(r),c=0;case 9:if(!(c<a.length)){e.next=20;break}if(a[c].name!==n.beneName||!1!==a[c].readmessage||a[c].contactwith!==m){e.next=16;break}return N(!0),b(a[c]),e.abrupt("break",20);case 16:N(!1);case 17:c++,e.next=9;break;case 20:e.next=24;break;case 22:e.prev=22,e.t0=e.catch(0);case 24:case"end":return e.stop()}}),e,null,[[0,22]])})))).apply(this,arguments)}(0,c.useEffect)((function(){!function(e){R.apply(this,arguments)}(n.beneEmail)}),[]),(0,c.useEffect)((function(){O()}),[d]);var W,V=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.from("Messaging").update({readmessage:!0}).match({name:n.beneName,contactwith:m}).select();case 3:t=e.sent,t.data,O(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return(0,i.jsx)(i.Fragment,{children:"active"===n.status&&(0,i.jsx)("div",{children:(0,i.jsxs)("div",{onClick:function(){return l(n.beneName),x(n.id),u(!0),V(),p(t),f(F),void h(n.onlineStatus)},className:"hover:bg-[#0047ab2d] hover:text-white flex p-1 cursor-pointer hover:p-2 duration-300",children:[(0,i.jsxs)("div",{className:"w-[100%] flex items-center gap-1",children:[M?(0,i.jsxs)("div",{className:"flex items-end",children:[(0,i.jsx)("img",{src:S,className:"h-[40px] w-[40px] rounded-full border-2 border-white"}),"online"===n.onlineStatus?(0,i.jsx)("div",{className:"bg-green-400 h-[13px] w-[13px] -ml-3 rounded-full border-2 border-white"}):(0,i.jsx)("div",{className:"bg-gray-400 h-[13px] w-[13px] -ml-3 rounded-full border-2 border-white"})]}):(W=n.beneName,(0,i.jsxs)("div",{className:"flex items-end",children:[(0,i.jsx)("div",{style:{background:B(W)},className:"flex text-white items-center justify-center h-[40px]  w-[40px] rounded-full font-thin border-2 border-white ",children:"".concat(W.toUpperCase().split(" ")[0][0])}),"online"===n.onlineStatus?(0,i.jsx)("div",{className:"bg-green-400 h-[13px] w-[13px] -ml-3 rounded-full border-2 border-white"}):(0,i.jsx)("div",{className:"bg-gray-400 h-[13px] w-[13px] -ml-3 rounded-full border-2 border-white"})]})),(0,i.jsxs)("div",{className:"grid",children:[(0,i.jsx)("p",{className:"text-black text-[13px] font-sans font-semibold capitalize ",children:n.beneName}),(0,i.jsx)("p",{className:"text-black text-[10px] font-sans font-semibold",children:"".concat("ADVISER"!==n.position?"".concat(n.position):"".concat(n.position," | ").concat(n.filterby))})]})]}),D>0&&(0,i.jsx)("div",{className:" text-red-600 font-bold flex items-start",children:(0,i.jsxs)("div",{className:"text-[9px] flex items-center",children:[(0,i.jsx)("div",{className:"h-2 w-2 rounded-full bg-red-600"}),"+",D]})})]})})})},d=n(72426),u=n.n(d);var m=n(75589),x=n(53532);var p=function(e){var t,n,s=e.e,a=e.userInfo,o=e.ID,l=e.name,d=e.receivedmessages,u=(0,c.useState)(),m=(0,r.Z)(u,2),p=m[0],f=m[1],h=(0,c.useState)(),g=(0,r.Z)(h,2),v=g[0],b=g[1];return console.log(a.beneName+" "+o),(0,i.jsxs)("div",{className:"",children:[(n=s.name,t=n,(0,i.jsx)(i.Fragment,{children:d.map((function(e){return(0,i.jsxs)("div",{children:[e.name===a.studname&&n===e.message&&(0,i.jsx)("img",{onClick:function(){return b(!v),void f("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(a.id,"_").concat(o,"/").concat(a.id,"/").concat(t))},className:"w-[240px] h-[200px]",src:"https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(a.id,"_").concat(o,"/").concat(a.id,"/").concat(n)}),e.name===l&&n===e.message&&(0,i.jsx)("img",{onClick:function(){return b(!v),void f("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(a.id,"_").concat(o,"/").concat(o,"/").concat(t))},className:"w-[240px] h-[200px] ",src:"https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(a.id,"_").concat(o,"/").concat(o,"/").concat(n)})]})}))})),(0,i.jsx)(x.Z,{imgsrc:p,name:s.name,onClose:b,visible:v})]})},f=n(64802),h=n(31243),g=(n(20216),n(78820));var v=function(e){var t=e.e,n=e.userInfo,r=e.ID;function c(){return(c=(0,a.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.Z.head("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(n.id,"_").concat(r,"/").concat(n.id,"/").concat(t.name));case 3:return e.sent,e.abrupt("return",(0,f.saveAs)("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(n.id,"_").concat(r,"/").concat(n.id,"/").concat(t.name),t.name));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",(0,f.saveAs)("https://ouraqybsyczzrrlbvenz.supabase.co/storage/v1/object/public/MessageFileUpload/".concat(n.id,"_").concat(r,"/").concat(r,"/").concat(t.name),t.name));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{onClick:function(){return function(){return c.apply(this,arguments)}()},className:"flex items-center mt-1 cursor-default",children:[(0,i.jsx)("div",{className:"h-[60px] w-[60px] p-2 bg-slate-400 flex place-content-center items-center rounded-l-md",children:(0,i.jsx)(g.xNt,{className:"text-slate-100"})}),(0,i.jsx)("div",{className:"h-[60px] p-2  bg-blue-900 w-[100%] flex items-center rounded-r-md  text-white font-light  ",children:(0,i.jsxs)("label",{className:"w-[160px]  truncate",children:[" ",t.name]})})]})})},b=n(16856),w=n(39126),j=n(84373),N=n(40071),y=n(76053),Z=n(41578),S=n(48273),k=n(75985);n(2384).Z.register();var z=function(e){var t=e.studemail,n=(0,c.useState)(""),d=(0,r.Z)(n,2),x=d[0],f=d[1],h=(0,c.useState)([]),z=(0,r.Z)(h,2),C=z[0],M=z[1],_=(0,c.useState)(""),E=(0,r.Z)(_,2),I=E[0],F=E[1],U=(0,c.useState)(),L=(0,r.Z)(U,2),A=L[0],D=L[1],q=(0,c.useState)(),B=(0,r.Z)(q,2),R=B[0],O=B[1],P=(0,c.useState)([]),W=(0,r.Z)(P,2),V=W[0],G=W[1],H=(0,c.useState)([]),T=(0,r.Z)(H,2),K=T[0],Y=T[1],X=(0,c.useState)(""),J=(0,r.Z)(X,2),Q=J[0],$=J[1],ee=(0,c.useState)(!0),te=(0,r.Z)(ee,2),ne=te[0],se=te[1],ae=(0,c.useState)(),re=(0,r.Z)(ae,2),ce=re[0],oe=re[1],ie=(0,c.useState)(),le=(0,r.Z)(ie,2),de=(le[0],le[1],(0,c.useRef)(null)),ue=(0,c.useState)(window.innerWidth<=768),me=(0,r.Z)(ue,2),xe=me[0],pe=me[1],fe=(0,c.useState)(window.innerWidth>=768),he=(0,r.Z)(fe,2),ge=(he[0],he[1]),ve=(0,c.useState)(!1),be=(0,r.Z)(ve,2),we=be[0],je=be[1],Ne=(0,c.useState)(!1),ye=(0,r.Z)(Ne,2),Ze=ye[0],Se=ye[1],ke=(0,c.useState)(!1),ze=(0,r.Z)(ke,2),Ce=ze[0],Me=ze[1],_e=(0,c.useState)(!1),Ee=(0,r.Z)(_e,2),Ie=Ee[0],Fe=(Ee[1],(0,c.useState)("")),Ue=(0,r.Z)(Fe,2),Le=Ue[0],Ae=Ue[1],De=(0,c.useState)(!1),qe=(0,r.Z)(De,2),Be=qe[0],Re=qe[1],Oe=(0,c.useState)(""),Pe=(0,r.Z)(Oe,2),We=Pe[0],Ve=Pe[1],Ge=(0,c.useState)(!1),He=(0,r.Z)(Ge,2),Te=He[0],Ke=He[1],Ye=(0,c.useState)(),Xe=(0,r.Z)(Ye,2),Je=Xe[0],Qe=Xe[1],$e=(0,c.useState)(!1),et=(0,r.Z)($e,2),tt=et[0],nt=et[1],st=(0,c.useState)(!0),at=(0,r.Z)(st,2),rt=at[0],ct=at[1],ot=(0,c.useState)(!1),it=(0,r.Z)(ot,2),lt=it[0],dt=it[1],ut=(0,c.useState)(),mt=(0,r.Z)(ut,2),xt=(mt[0],mt[1],(0,c.useState)()),pt=(0,r.Z)(xt,2),ft=pt[0],ht=pt[1],gt=(0,c.useState)(),vt=(0,r.Z)(gt,2),bt=vt[0],wt=vt[1],jt=(0,c.useState)(!1),Nt=(0,r.Z)(jt,2);Nt[0],Nt[1];function yt(){return Zt.apply(this,arguments)}function Zt(){return(Zt=(0,a.Z)((0,s.Z)().mark((function e(){var n,a,r,c,i,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.from("StudentInformation").select().eq("studemail",t).single();case 2:if(n=e.sent,!(a=n.data)){e.next=16;break}return G(a.studname),Y(a),e.next=9,o.Z.from("BeneAccount").select().match({filterby:a.studcourse});case 9:return r=e.sent,c=r.data,e.next=13,o.Z.from("BeneAccount").select().match({filterby:"ALL"});case 13:i=e.sent,l=i.data,c&&M(c.concat(l));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,c.useEffect)((function(){var e=function(){pe(window.innerWidth<=768),ge(window.innerWidth>=768),window.innerWidth<=768&&!0===Ze&&Se(!0)};e(),window.addEventListener("resize",e)}),[ce]),(0,c.useEffect)((function(){yt();o.Z.channel("custom-update-channel").on("postgres_changes",{event:"UPDATE",schema:"public",table:"BeneAccount"},(function(e){yt()})).on("postgres_changes",{event:"UPDATE",schema:"public",table:"StudentInformation"},(function(e){yt()})).subscribe()}),[]),(0,c.useEffect)((function(){St();o.Z.channel("custom-all-channel").on("postgres_changes",{event:"*",schema:"public",table:"Messaging",filter:"contactwith=eq.".concat(V)},(function(e){var t;St(),null===(t=de.current)||void 0===t||t.scrollIntoView()})).on("postgres_changes",{event:"*",schema:"public",table:"Messaging",filter:"name=eq.".concat(V)},(function(e){var t;St(),null===(t=de.current)||void 0===t||t.scrollIntoView()})).on("presence",{event:"sync",table:"Messaging"},(function(e){var n=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.from("StudentInformation").update({onlineStatus:"online"}).eq("studemail",t).single();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n()})).subscribe()}),[I]);var St=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var t,n,a,r,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.from("Messaging").select().order("created_at",{ascending:!1}).match({name:V,contactwith:I});case 3:return n=e.sent,a=n.data,e.next=7,o.Z.from("Messaging").select().order("created_at",{ascending:!1}).match({name:I,contactwith:V});case 7:return r=e.sent,c=r.data,e.next=11,oe(a.concat(c));case 11:null===(t=de.current)||void 0===t||t.scrollIntoView(),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(0);case 16:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();function kt(){return zt.apply(this,arguments)}function zt(){return(zt=(0,a.Z)((0,s.Z)().mark((function e(){var t,n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.from("Messaging").insert([{name:V,message:Q,contactwith:I,readmessage:!1,userID:K.id}]);case 2:return t=e.sent,t.data,t.error,n={name:V,message:Q.trim(),contactwith:I,userID:K.id,created_at:u()().format()},oe(ce.concat(ce.push(n))),e.next=9,o.Z.from("StudentInformation").update({last_Modif:u()().format()}).eq("studname",V);case 9:a=e.sent,a.data,Me(!1),$(""),se(!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ct(){return(Ct=(0,a.Z)((0,s.Z)().mark((function e(){var t,n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.from("Messaging").insert([{name:V,message:"\ud83d\udc4d\ud83c\udffb",contactwith:I,userID:K.id}]);case 2:return n=e.sent,n.data,n.error,a={name:V,message:"\ud83d\udc4d\ud83c\udffb",contactwith:I,userID:K.id,created_at:u()().format()},oe(ce.concat(ce.push(a))),e.next=9,o.Z.from("StudentInformation").update({last_Modif:u()().format()}).eq("studname",V);case 9:Me(!1),$(""),se(!0),_t(),null===(t=de.current)||void 0===t||t.scrollIntoView();case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Mt=(0,c.useRef)(null);function _t(){return Et.apply(this,arguments)}function Et(){return(Et=(0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.from("Messaging").update({readmessage:!0}).match({name:I,contactwith:V}).select();case 2:t=e.sent,t.data;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function It(){Ke(!Te),Ut(A),window.innerWidth<=768&&(Te?(document.getElementById("contact").hidden=!1,document.getElementById("message").hidden=!1):(document.getElementById("contact").hidden=!0,document.getElementById("message").hidden=!0))}function Ft(){return Ft=(0,a.Z)((0,s.Z)().mark((function e(){var t,n,a,r,c,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(!0),ct(!0),Me(!1),$(""),se(!0),t=Math.ceil(99999999*Math.random()),e.next=8,o.Z.storage.from("MessageFileUpload").upload(K.id+"_"+A+"/"+K.id+"/"+t+"."+We,Le);case 8:if(n=e.sent,a=n.data,r=n.error,!a){e.next=25;break}return e.next=14,o.Z.from("Messaging").insert([{name:V,message:t+"."+We,contactwith:I,userID:K.id}]);case 14:return c=e.sent,c.data,e.next=18,o.Z.from("StudentInformation").update({last_Modif:u()().format()}).eq("studname",V);case 18:i=e.sent,i.data,nt(!1),ct(!1),Ae(),Ve(),Re(!1);case 25:r&&k.Am.warn("Something went wrong please try again..",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"});case 26:case"end":return e.stop()}}),e)}))),Ft.apply(this,arguments)}function Ut(e){return Lt.apply(this,arguments)}function Lt(){return(Lt=(0,a.Z)((0,s.Z)().mark((function e(t){var n,a,r,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.storage.from("MessageFileUpload").list("".concat(K.id+"_"+t)+"/"+K.id,{limit:50,offset:0,sortBy:{column:"name",order:"asc"}});case 2:return n=e.sent,a=n.data,e.next=6,o.Z.storage.from("MessageFileUpload").list("".concat(K.id+"_"+t)+"/"+t,{limit:50,offset:0,sortBy:{column:"name",order:"asc"}});case 6:r=e.sent,c=r.data,Qe(c.concat(a));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var At=(0,c.useState)([]),Dt=(0,r.Z)(At,2),qt=Dt[0],Bt=(Dt[1],["jpg","jpeg","png","gif","bmp"]),Rt=["docx","pdf","ods","pptx","xlsx"],Ot=function(e){return!!Bt.includes(e.split(".").pop().toLowerCase())||!Rt.includes(e.split(".").pop().toLowerCase())&&void 0};var Pt,Wt=(0,c.useRef)(),Vt=(0,c.useState)(!1),Gt=(0,r.Z)(Vt,2),Ht=(Gt[0],Gt[1],(0,c.useRef)(null)),Tt=function(e){Ht.current&&!Ht.current.contains(e.target)&&It()};return(0,c.useEffect)((function(){return document.addEventListener("mousedown",Tt),function(){document.removeEventListener("mousedown",Tt)}}),[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"w-[100%] h-screen md:pt-[2%] pt-[12%] p-10 flex justify-center ",children:(0,i.jsxs)("div",{className:"  h-[87%] w-[100%] md:p-5 p-0 flex md:gap-3 gap-1 rounded-md  bg-[#90bbdf] bg-opacity-20",children:[(0,i.jsxs)("div",{id:"contact",className:"".concat(window.innerWidth<=768?"  ".concat(Ze?"hidden":"md:w-[250px] w-[100%] md:h-[100%] h-[90%] md:flex-col bg-slate-100 rounded-l-md shadow-md shadow-black"):"md:w-[250px] w-[100%] md:h-[100%] h-[90%] md:flex-col bg-slate-100 rounded-l-md shadow-md shadow-black"),children:[(0,i.jsxs)("p",{className:"font-bold text-[25px] h-[51px] text-center pt-1 text-white rounded-tl-md bg-[#274472] flex items-center justify-center ",children:[(0,i.jsx)(j.Y_V,{className:"text-[25px] text-white mr-0.5  mt-1"}),"Contacts"]}),(0,i.jsx)("center",{children:(0,i.jsxs)("div",{className:"bg-slate-300 flex w-[96%] rounded-md place-content-center mt-2 mb-2 ",children:[(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:"h-[13px] w-10 mt-2.5 ml-2",children:(0,i.jsx)("path",{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"})}),(0,i.jsx)("input",{value:x,onChange:function(e){return f(e.target.value)},type:"text",className:"w-[100%] bg-slate-300 p-1 border-0 outline-none rounded-md",placeholder:"Search Here"})]})}),C&&(0,i.jsx)("div",{className:"h-[80%] rounded-bl-md overflow-y-auto scroll-smooth",children:C.filter((function(e){try{if(""===x)return e;if(e.beneName.toLowerCase().includes(x.toLowerCase()))return e;if(e.beneEmail.toLowerCase().includes(x.toLowerCase()))return e}catch(t){}})).sort((function(e,t){var n=new Date(e.last_Modif),s=new Date(t.last_Modif);return n.getTime()<=s.getTime()?1:-1})).map((function(e){return(0,i.jsx)(l,{beneinfo:e,setGetBeneName:F,setShowMessage:Se,setShowContacts:je,message:ce,studName:V,setGetID:D,setAvatarColor:ht,setAvatarURL:wt,setOnlineStatus:O},e.id)}))})]}),(0,i.jsx)("div",{id:"message",className:" ".concat(window.innerWidth<=768?"  ".concat(Ze||Te?"w-[100%] md:h-[100%] h-[90%] bg-[#274472] rounded-r-md shadow-md shadow-black":"hidden"):"w-[100%] md:h-[100%] h-[90%] bg-[#274472] rounded-r-md shadow-md shadow-black"),children:I?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:" p-2 flex",children:[xe&&(0,i.jsx)("div",{onClick:function(){return Se(!Ze),void(!1===we?(je(!0),Ut(A)):je(!1))},className:" pt-1 group",children:(0,i.jsx)(b.rpj,{className:"text-[25px] text-white group-hover:text-slate-400 "})}),bt?(0,i.jsxs)("div",{className:"flex items-end",children:[(0,i.jsx)("img",{src:bt,className:"h-[40px] w-[40px] rounded-full border-2 border-[#274472]"}),"online"===R?(0,i.jsx)("div",{className:"bg-green-400 h-[13px] w-[13px] -ml-3 rounded-full  border-2 border-[#274472]"}):(0,i.jsx)("div",{className:"bg-gray-400 h-[13px] w-[13px] -ml-3 rounded-full  border-2 border-[#274472]"})]}):(Pt=I,(0,i.jsxs)("div",{className:"flex items-end",children:[(0,i.jsx)("div",{style:{background:ft},className:"flex text-white items-center justify-center h-[40px]  w-[40px] rounded-full font-thin  border-2 border-[#274472]",children:"".concat(Pt.toUpperCase().split(" ")[0][0])}),"online"===R?(0,i.jsx)("div",{className:"bg-green-400 h-[13px] w-[13px] -ml-3 rounded-full border-2 border-[#274472]"}):(0,i.jsx)("div",{className:"bg-gray-400 h-[13px] w-[13px] -ml-3 rounded-full border-2 border-[#274472]"})]})),(0,i.jsx)("div",{onClick:function(){return It()},className:" flex items-center p-1 pl-[1%] mt-0.5 text-[15px] font-semibold text-white cursor-pointer  hover:underline hover:text-blue-500 capitalize",children:I})]}),ce?(0,i.jsxs)("div",{ref:Wt,onScroll:function(){},className:" md:h-[76%] h-[80%] w-[100%] bg-[#bfd7eddc]  p-3 overflow-y-auto",children:[ce.sort((function(e,t){return e.created_at<t.created_at?-1:1})).map((function(e){return(0,i.jsx)(m.Z,{message:e,getstudname:I,beneName:V,beneinfo:K,studID:A,file:Je,displayfile:qt,avatarURL:bt,allbeneinfo:C},e.id)})),(0,i.jsx)("div",{ref:de}),Ie&&(0,i.jsxs)("div",{className:"text-[10px] text-blue-700 flex justify-end",children:["Delivered",(0,i.jsx)(g.mny,{className:"mt-0.5 ml-0.5"})]}),Ce&&(0,i.jsxs)("div",{className:" flex justify-end text-[10px]",children:["Seen by ",I]})]}):(0,i.jsx)("div",{children:"No Messages Found"}),(0,i.jsxs)("div",{className:"flex flex-col w-[100%] h-[50%] ",children:[(0,i.jsx)("input",{accept:"e.g:.jpg,.jpeg,.png,.gif,.bmp,.docx,.pdf,.ods,.pptx,.xlsx",type:"file",onChange:function(e){var t=e.target.files[0];void 0!==t&&(Ae(t),Ve(t.name),t&&Re(!0))},ref:Mt,style:{display:"none"}}),(0,i.jsxs)("div",{className:"flex w-[100%] h-[100%] ",children:[(0,i.jsx)("button",{className:"button-upload ml-1 mt-4 hover:bg-slate-300 bg-white p-2 rounded-full h-fit items-center justify-center ",onClick:function(e){Mt.current.click()},children:(0,i.jsx)(y.Ypb,{className:""})}),Be?(0,i.jsx)("div",{className:"absolute -mt-[35px] ml-[2%] ",children:(0,i.jsxs)("div",{className:"flex w-[100%] gap-2",children:[(0,i.jsx)("a",{disabled:rt,onClick:function(){return Ae(),void Re(!1)},className:"".concat(rt?"rounded-full bg-slate-600 h-[20px] w-[20px] p-4 justify-center flex items-center hover:bg-red-400 cursor-pointer text-white hover:text-black":"hidden"),children:"X"}),(0,i.jsxs)("div",{className:"flex bg-[#5584ab] rounded-md",children:[(0,i.jsx)("label",{className:"flex items-center pl-2 pr-2 text-white ",children:We}),(0,i.jsx)("button",{onClick:function(){return function(){return Ft.apply(this,arguments)}()},className:"".concat(tt?"bg-gray-500":"bg-[#60A3D9] hover:bg-blue-500 hover:shadow-lg"," h-[20px] p-4 flex text-slate-200  hover:text-black  font-semibold justify-center items-center rounded-sm"),children:tt?(0,i.jsxs)("div",{className:"flex gap-1 text-white",children:["Sending",(0,i.jsx)(S.gy,{height:"25",width:"25",color:"#ffffff",ariaLabel:"tail-spin-loading",radius:"0",wrapperStyle:{},visible:!0})]}):"SEND"})]})]})}):"",(0,i.jsxs)("div",{className:"visible w-full h-auto justify-center flex",children:[(0,i.jsx)("textarea",{onKeyDown:function(e){"Enter"===e.key&&Q.split("\n")[Q.split("\n").length-1].length>0&&kt()},value:Q,onChange:function(e){e.target.value.length>=0&&($(e.target.value),se(!1)),e.target.value.length<=1&&se(!0)},onClick:function(){return _t()},rows:"3",className:"mt-2 mb-2 ml-1 p-1 w-[100%]  h-[50px] text-sm text-gray-900  rounded-md resize-none",placeholder:"Write Remaks Here.."}),""===Q?(0,i.jsx)("button",{onClick:function(){return function(){return Ct.apply(this,arguments)}()},className:"bg-[#60A3D9] group h-[50px] w-[55px] rounded-full flex items-center justify-center ml-[10px] mr-[10px] mt-[8px]  ",children:(0,i.jsx)(j.rdj,{className:" text-[#274472] group-hover:text-white md:text-[30px] text-[25px]"})}):(0,i.jsx)("button",{onClick:function(){return kt()},disabled:ne,className:"".concat(ne?" bg-[#60A3D9] group  h-[50px] w-[55px] rounded-full flex items-center justify-center ml-[10px] mr-[10px] mt-[8px] hover:ring-1 hover:ring-white":"bg-[#60A3D9] group  h-[50px] w-[55px] rounded-full flex items-center justify-center ml-[10px] mr-[10px] mt-[8px] hover:ring-1 hover:ring-white"),children:(0,i.jsx)(N.yhK,{className:"".concat(ne?" text-[#274472] md:text-[30px] text-[20px]":" text-[#274472] group-hover:text-white md:text-[30px] text-[20px]","  ")})})]})]})]})]}):(0,i.jsxs)("div",{className:"flex flex-col place-content-center items-center justify-center h-[100%] text-white",children:[(0,i.jsx)(Z.me0,{className:"text-[200px]"}),(0,i.jsx)("label",{className:"text-[30px] font-bold",children:"No chats selected"})]})}),Te?(0,i.jsx)("div",{ref:Ht,className:"h-[100%] w-full",children:(0,i.jsxs)("div",{ref:Ht,className:"".concat(window.innerWidth<=768?"".concat(Te?" w-full  bg-slate-200 h-[100%] overflow-auto shadow-md shadow-black rounded-r-md ":"hidden "):"  w-[250px] bg-slate-200 h-[100%] overflow-auto shadow-md shadow-black rounded-r-md ","  "),children:[(0,i.jsxs)("div",{ref:Ht,className:"bg-[#274472] p-3 flex text-[15px] gap-1 text-white font-bold rounded-tr-md",children:[xe&&(0,i.jsx)("div",{onClick:function(){return It()},className:" pt-1 group",children:(0,i.jsx)(b.rpj,{className:"text-[25px] text-white group-hover:text-slate-400 "})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 w-[100%] ",children:[(0,i.jsxs)("a",{onClick:function(){return dt(!lt)},className:"".concat(lt?"":"bg-slate-200 text-slate-700"," hover:text-blue-400 flex items-center gap-1 cursor-pointer rounded-md p-1 justify-center"),children:[(0,i.jsx)(w.vGR,{className:"text-[20px]"}),"IMAGE"]}),(0,i.jsxs)("a",{onClick:function(){return dt(!lt)},className:"".concat(lt?"bg-slate-200 text-slate-700":""," hover:text-blue-400 flex items-center gap-1 cursor-pointer rounded-md p-1 justify-center"),children:[(0,i.jsx)(g.y6u,{className:"text-[20px]"}),"FILE"]})]})]}),(0,i.jsx)("div",{className:"flex flex-col items-center justify-center p-1 mt-2 text-[10px] font-semibold",children:(0,i.jsx)("p",{children:"File Uploaded "})}),lt?(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"md:w-[100%] p-2",children:null===Je||void 0===Je?void 0:Je.sort((function(e,t){return e.created_at<=t.created_at?1:-1})).map((function(e){return(0,i.jsx)("div",{children:!1===Ot(e.name)&&(0,i.jsx)(v,{e:e,ID:A,userInfo:K})})}))})}):(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"w-[100%] p-1",children:null===Je||void 0===Je?void 0:Je.sort((function(e,t){return e.created_at<=t.created_at?1:-1})).map((function(e){return(0,i.jsx)("div",{className:"mt-0.5 rounded-md bg-gray-300",children:!0===Ot(e.name)&&(0,i.jsx)(p,{e:e,userInfo:K,ID:A,name:I,receivedmessages:ce},e.id)})}))})})]})}):""]})}),(0,i.jsx)(k.Ix,{position:"top-right",autoClose:5e3,limit:1,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!1,theme:"light"})]})}}}]);
//# sourceMappingURL=259.04f90bc8.chunk.js.map