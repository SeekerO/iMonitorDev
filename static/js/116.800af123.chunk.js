"use strict";(self.webpackChunkimonitor=self.webpackChunkimonitor||[]).push([[116],{60116:function(e,t,n){n.r(t);var s=n(74165),r=n(15861),a=n(29439),c=n(72791),o=n(11087),i=n(43621),l=n(67945),u=n.n(l),d=(n(24655),n(72426)),m=n.n(d),h=n(80184);t.default=function(e){var t=e.email,n=(0,c.useState)(!0),l=(0,a.Z)(n,2),d=l[0],f=l[1],x=(0,c.useState)(!1),p=(0,a.Z)(x,2),v=p[0],w=p[1],g=(0,c.useState)(),b=(0,a.Z)(g,2),j=(b[0],b[1]),N=(0,c.useState)(),Z=(0,a.Z)(N,2),H=Z[0],k=Z[1],C=(0,c.useState)(0),L=(0,a.Z)(C,2),y=L[0],z=L[1];(0,c.useEffect)((function(){u().init()}),[]),(0,c.useEffect)((function(){I(),E(),i.Z.channel("custom-filter-channel").on("postgres_changes",{event:"*",schema:"public",table:"Messaging"},(function(e){I()})).on("postgres_changes",{event:"*",schema:"public",table:"AnnouncementTable"},(function(e){E()})).subscribe()}),[]);var A=(0,c.useState)(0),M=(0,a.Z)(A,2),S=M[0],V=M[1];function E(){return B.apply(this,arguments)}function B(){return(B=(0,r.Z)((0,s.Z)().mark((function e(){var n,r,a,c,o,l,u,d,m,h,f;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.from("AnnouncementTable").select("*",{count:"exact"});case 2:for(n=e.sent,r=n.data,a=n.count,c=t,o=0,l=function(e){V(a-e),e!==a&&k(!0),e===a&&k(!1)},u=0;u<r.length;u++)for(d=[r[u]],m=0;m<d.length;m++)for(h=d[m].readsBy,f=0;f<h.length;f++)h[f]===c&&o++;l(o);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return U.apply(this,arguments)}function U(){return(U=(0,r.Z)((0,s.Z)().mark((function e(){var n,r,a,c,o,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.from("StudentInformation").select().eq("studemail",t).single();case 2:return n=e.sent,r=n.data,e.next=6,i.Z.from("Messaging").select("*",{count:"exact"}).match({contactwith:r.studname,readmessage:"FALSE"});case 6:for(a=e.sent,c=a.data,o=a.count,z(o),l=0;l<c.length;l++)!1===c[l].readmessage?w(!0):w(!1);j(c);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=(0,c.useRef)(null),D=function(e){q.current&&!q.current.contains(e.target)&&f(!0)};function F(){return(F=(0,r.Z)((0,s.Z)().mark((function e(){var n,r,a,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m()(new Date).format("LLL"),e.next=3,i.Z.from("StudentInformation").select().eq("studemail",t).single();case 3:if(r=e.sent,!(a=r.data)){e.next=10;break}return e.next=8,i.Z.from("ActivityLog").insert([{name:a.studname,button:"Logged In",time:n}]);case 8:c=e.sent,c.data;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,c.useEffect)((function(){return document.addEventListener("mousedown",D),function(){document.removeEventListener("mousedown",D)}}),[]),(0,c.useEffect)((function(){!function(){F.apply(this,arguments)}()}),[t]),(0,h.jsx)("div",{className:"flex flex-col relative z-99 ",children:(0,h.jsxs)("div",{ref:q,className:"".concat(d?"transition-transform -translate-x-full duration-300":"transition-transform translate-x-0 duration-500"," absolute flex w-52 h-screen  bg-[#5885AF] transition-transform  -translate-x-full md:translate-x-0"),children:[(0,h.jsxs)("div",{className:"ml-[208px] pt-[10px] absolute flex",onClick:function(){f(!d)},children:[(0,h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"".concat(d?"rotate-0 duration-300":" rotate-180 duration-300"," w-7 h-7 text-white  hover:text-[#60A3D9] hover:cursor-pointer md:hidden visible"),children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 4.5l7.5 7.5-7.5 7.5m-6-15l7.5 7.5-7.5 7.5"})}),v||H?(0,h.jsx)("div",{className:"h-4 w-4  rounded-full bg-red-500 md:hidden visible"}):""]}),(0,h.jsx)("aside",{className:"relative",children:(0,h.jsxs)("div",{className:"px-3 py-4 ",children:[(0,h.jsxs)(o.rU,{to:"/",onClick:function(){return f(!d)},className:"flex items-center p-2 rounded-lg text-white hover:bg-[#274472] transform hover:translate-x-2 hover:shadow-md",children:[(0,h.jsx)("svg",{"aria-hidden":"true",className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 576 512",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{d:"M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm80 256h64c44.2 0 80 35.8 80 80c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16c0-44.2 35.8-80 80-80zm-32-96a64 64 0 1 1 128 0 64 64 0 1 1 -128 0zm256-32H496c8.8 0 16 7.2 16 16s-7.2 16-16 16H368c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64H496c8.8 0 16 7.2 16 16s-7.2 16-16 16H368c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64H496c8.8 0 16 7.2 16 16s-7.2 16-16 16H368c-8.8 0-16-7.2-16-16s7.2-16 16-16z"})}),(0,h.jsx)("span",{className:"ml-3",children:"Attendance"})]}),(0,h.jsxs)(o.rU,{to:"/Announcement",onClick:function(){f(!d)},className:"flex items-center p-2 rounded-lg text-white hover:bg-[#274472] transform hover:translate-x-2 hover:shadow-md",children:[(0,h.jsx)("svg",{"aria-hidden":"true",className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 576 512",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{d:"M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"})}),(0,h.jsxs)("span",{className:"ml-3 flex",children:["Announcement"," ",(0,h.jsx)("em",{children:H&&(0,h.jsx)("div",{className:"bg-red-500 h-3 w-3 rounded-full ml-1"})})]}),H&&(0,h.jsxs)("label",{className:"text-[8px] ml-2 p-0.5 rounded-sm bg-slate-500 text-white",children:["+",S]})]}),(0,h.jsx)(o.rU,{to:"/Message",onClick:function(){return f(!d)},className:"flex items-center p-2 rounded-lg text-white hover:bg-[#274472] transform hover:translate-x-2 hover:shadow-md",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("svg",{"aria-hidden":"true",className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{d:"M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64h96v80c0 6.1 3.4 11.6 8.8 14.3s11.9 2.1 16.8-1.5L309.3 416H448c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64z"})}),(0,h.jsxs)("span",{className:"ml-3 flex ",children:["Message",y>0&&(0,h.jsx)("div",{className:"h-[12px] w-[12px] bg-red-500 rounded-full"})]}),y>0&&(0,h.jsxs)("label",{className:"text-white bg-gray-500 rounded-md h-fit px-1 font-semibold font-mono text-[10px] items-center flex ml-[40px]",children:["+",y]})]})})]})})]})})}}}]);
//# sourceMappingURL=116.800af123.chunk.js.map